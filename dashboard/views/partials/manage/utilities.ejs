<div class="plugin-card">
    <div class="plugin-card-header">
        <h4><i class="fas fa-bullhorn me-2"></i> Auto-Publisher</h4>
    </div>
    <div class="plugin-card-body">
        <form action="/manage/<%= guild.id %>/update-autopublisher" method="POST">
            <p class="text-muted">When enabled, the bot will automatically publish any new messages sent in your server's Announcement Channels.</p>
            <div class="form-check form-switch">
                <input class="form-check-input" type="checkbox" role="switch" id="autopublisher-enabled" name="is_enabled" <%= (autoPublisherConfig && autoPublisherConfig.is_enabled) ? 'checked' : '' %>>
                <label class="form-check-label" for="autopublisher-enabled">Enable Auto-Publisher</label>
            </div>
            <div class="d-flex justify-content-end mt-3">
                <button type="submit" class="btn btn-primary">Save Changes</button>
            </div>
        </form>
    </div>
</div>

<div class="plugin-card">
    <div class="plugin-card-header">
        <h4><i class="fas fa-user-plus me-2"></i> Autoroles</h4>
    </div>
    <div class="plugin-card-body">
        <form action="/manage/<%= guild.id %>/update-autoroles" method="POST">
             <p class="text-muted">Automatically assign roles to new members when they join the server. The bot's role must be higher than the roles you want to assign.</p>
            <div class="mb-3">
                 <label for="autoroles-roles" class="form-label">Roles to Assign on Join</label>
                <select class="form-select" id="autoroles-roles" name="roles_to_assign" multiple size="5">
                    <% const assignedRoles = autorolesConfig && autorolesConfig.roles_to_assign ? JSON.parse(autorolesConfig.roles_to_assign) : []; %>
                    <% roles.forEach(role => { %>
                        <option value="<%= role.id %>" <%= assignedRoles.includes(role.id) ? 'selected' : '' %> >@<%= role.name %></option>
                    <% }); %>
                </select>
                <div class="form-text">Hold Ctrl/Cmd to select multiple roles.</div>
            </div>
             <div class="form-check form-switch">
                <input class="form-check-input" type="checkbox" role="switch" id="autoroles-enabled" name="is_enabled" <%= (autorolesConfig && autorolesConfig.is_enabled) ? 'checked' : '' %>>
                <label class="form-check-label" for="autoroles-enabled">Enable Autoroles</label>
            </div>
            <div class="d-flex justify-content-end mt-3">
                <button type="submit" class="btn btn-primary">Save Changes</button>
            </div>
        </form>
    </div>
</div>

<div class="plugin-card mt-4">
    <div class="plugin-card-header">
        <h4><i class="fas fa-magnet me-2"></i> Sticky Roles</h4>
    </div>
    <div class="plugin-card-body">
        <form action="/manage/<%= guild.id %>/update-stickyroles" method="POST">
            <p class="text-muted">When enabled, the bot will remember a user's roles when they leave and automatically re-assign them if they rejoin.</p>
            <div class="form-check form-switch">
                <input class="form-check-input" type="checkbox" role="switch" id="stickyroles-enabled" name="sticky_roles_enabled" <%= (settings && settings.sticky_roles_enabled) ? 'checked' : '' %>>
                <label class="form-check-label" for="stickyroles-enabled">Enable Sticky Roles</label>
            </div>
            <div class="d-flex justify-content-end mt-3">
                <button type="submit" class="btn btn-primary">Save Changes</button>
            </div>
        </form>
    </div>
</div>

<div class="plugin-card mt-4">
    <div class="plugin-card-header">
        <h4><i class="fas fa-plus-circle me-2"></i> Auto Voice Channels</h4>
    </div>
    <div class="plugin-card-body">
        <form action="/manage/<%= guild.id %>/update-tempchannels" method="POST">
            <p class="text-muted">Set up a "Join to Create" channel. When a user joins it, the bot will create a temporary voice channel for them.</p>

            <div class="mb-3">
                <label for="creator-channel" class="form-label">Creator Channel</label>
                <select class="form-select" name="creator_channel_id" id="creator-channel">
                    <option value="">-- Disable System --</option>
                    <% voiceChannels.forEach(vc => { %>
                        <option value="<%= vc.id %>" <%= (tempChannelConfig && tempChannelConfig.creator_channel_id === vc.id) ? 'selected' : '' %> >#<%= vc.name %></option>
                    <% }); %>
                </select>
            </div>

            <div class="mb-3">
                <label for="temp-category" class="form-label">Temporary Channel Category</label>
                <select class="form-select" name="category_id" id="temp-category">
                    <option value="">-- Select a Category --</option>
                    <% categories.forEach(cat => { %>
                        <option value="<%= cat.id %>" <%= (tempChannelConfig && tempChannelConfig.category_id === cat.id) ? 'selected' : '' %>><%= cat.name %></option>
                    <% }); %>
                </select>
            </div>
            
            <div class="mb-3">
                <label for="naming-template" class="form-label">Channel Naming Template</label>
                <input type="text" class="form-control" name="naming_template" id="naming-template" value="<%= (tempChannelConfig && tempChannelConfig.naming_template) ? tempChannelConfig.naming_template : '{user}''s Channel' %>">
                <div class="form-text">Use <code>{user}</code> as a placeholder for the user's display name.</div>
            </div>

            <div class="d-flex justify-content-end">
                <button type="submit" class="btn btn-primary">Save Settings</button>
            </div>
        </form>
    </div>
</div>