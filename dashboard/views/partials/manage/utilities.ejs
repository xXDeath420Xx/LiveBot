<div class="row">
    <div class="col-12">
        <h3>Utilities</h3>
        <p class="text-muted">Configure various server utilities to enhance your community.</p>
    </div>
</div>

<div class="content-card mt-4">
    <div class="card-body">
        <h4 class="card-title">Auto Publisher</h4>
        <p class="card-subtitle mb-3 text-muted">Automatically publish messages in your announcement channels.</p>
        <form action="/manage/<%= guild.id %>/update-autopublisher" method="POST">
            <div class="mb-3">
                <label for="autoPublisherEnabled" class="form-label">Enable Auto Publisher</label>
                <div class="form-check form-switch">
                    <input class="form-check-input" type="checkbox" role="switch" id="autoPublisherEnabled" name="is_enabled" <%= autoPublisher && autoPublisher.is_enabled ? 'checked' : '' %>>
                    <label class="form-check-label" for="autoPublisherEnabled">Enable</label>
                </div>
            </div>
            <button type="submit" class="btn btn-primary">Save Settings</button>
        </form>
    </div>
</div>

<div class="content-card mt-4">
    <div class="card-body">
        <h4 class="card-title">Autoroles</h4>
        <p class="card-subtitle mb-3 text-muted">Assign roles to members as soon as they join the server.</p>
        <form action="/manage/<%= guild.id %>/update-autoroles" method="POST">
            <div class="mb-3">
                <label for="autorolesEnabled" class="form-label">Enable Autoroles</label>
                <div class="form-check form-switch">
                    <input class="form-check-input" type="checkbox" role="switch" id="autorolesEnabled" name="is_enabled" <%= autoroles && autoroles.is_enabled ? 'checked' : '' %>>
                    <label class="form-check-label" for="autorolesEnabled">Enable</label>
                </div>
            </div>
            <div class="mb-3">
                <label for="autoroleRole" class="form-label">Role to Assign</label>
                <select class="form-select" id="autoroleRole" name="roles_to_assign">
                    <option value="">Select a role</option>
                    <% roles.forEach(role => { %>
                        <option value="<%= role.id %>" <%= autoroles && autoroles.roles_to_assign && JSON.parse(autoroles.roles_to_assign).includes(role.id) ? 'selected' : '' %>><%= role.name %></option>
                    <% }) %>
                </select>
            </div>
            <button type="submit" class="btn btn-primary">Save Settings</button>
        </form>
    </div>
</div>

<div class="content-card mt-4">
    <div class="card-body">
        <h4 class="card-title">Temporary Channels</h4>
        <p class="card-subtitle mb-3 text-muted">Create temporary voice channels that are deleted when empty.</p>
        <form action="/manage/<%= guild.id %>/update-tempchannels" method="POST">
            <div class="mb-3">
                <label for="tempChannelCreator" class="form-label">Creator Channel</label>
                <select class="form-select" id="tempChannelCreator" name="creator_channel_id">
                    <option value="">Select a voice channel</option>
                    <% voiceChannels.forEach(channel => { %>
                        <option value="<%= channel.id %>" <%= tempChannels && tempChannels.creator_channel_id === channel.id ? 'selected' : '' %>><%= channel.name %></option>
                    <% }) %>
                </select>
                 <div class="form-text">Users join this channel to create a new temporary channel.</div>
            </div>
            <div class="mb-3">
                <label for="tempChannelCategory" class="form-label">Channel Category</label>
                <select class="form-select" id="tempChannelCategory" name="category_id">
                    <option value="">Select a category</option>
                    <% categories.forEach(category => { %>
                        <option value="<%= category.id %>" <%= tempChannels && tempChannels.category_id === category.id ? 'selected' : '' %>><%= category.name %></option>
                    <% }) %>
                </select>
                <div class="form-text">New temporary channels will be created in this category.</div>
            </div>
            <div class="mb-3">
                <label for="tempChannelName" class="form-label">Channel Name Format</label>
                <input type="text" class="form-control" id="tempChannelName" name="naming_template" value="<%= tempChannels ? tempChannels.naming_template : '{username}\'s Channel' %>">
                <div class="form-text">Use {username} as a placeholder for the user's name.</div>
            </div>
            <button type="submit" class="btn btn-primary">Save Settings</button>
        </form>
    </div>
</div>
