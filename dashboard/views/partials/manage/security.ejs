<div class="plugin-card mt-4">
    <div class="plugin-card-header">
        <h4><i class="fas fa-shield-virus me-2"></i> Anti-Raid</h4>
    </div>
    <div class="plugin-card-body">
        <form action="/manage/<%= guild.id %>/update-antiraid" method="POST">
            <p class="text-muted">Automatically take action when a large number of users join in a short amount of time.</p>

            <div class="row">
                <div class="col-md-6 mb-3">
                    <label for="raid-limit" class="form-label">Join Limit</label>
                    <input type="number" class="form-control" name="join_limit" id="raid-limit" value="<%= antiRaidConfig ? antiRaidConfig.join_limit : 10 %>" min="2">
                    <div class="form-text">Number of users that can join before triggering the action.</div>
                </div>
                <div class="col-md-6 mb-3">
                    <label for="raid-time" class="form-label">Time Period (Seconds)</label>
                    <input type="number" class="form-control" name="time_period_seconds" id="raid-time" value="<%= antiRaidConfig ? antiRaidConfig.time_period_seconds : 10 %>" min="2">
                    <div class="form-text">The time window in which the joins must occur.</div>
                </div>
            </div>

            <div class="mb-3">
                <label for="raid-action" class="form-label">Action</label>
                <select name="action" id="raid-action" class="form-select">
                    <option value="kick" <%= (antiRaidConfig && antiRaidConfig.action === 'kick') ? 'selected' : '' %>>Kick all joining users</option>
                    <option value="ban" <%= (antiRaidConfig && antiRaidConfig.action === 'ban') ? 'selected' : '' %>>Ban all joining users</option>
                </select>
            </div>

            <div class="form-check form-switch mb-3">
                <input class="form-check-input" type="checkbox" role="switch" id="antiraid-enabled" name="is_enabled" <%= (antiRaidConfig && antiRaidConfig.is_enabled) ? 'checked' : '' %>>
                <label class="form-check-label" for="antiraid-enabled">Enable Anti-Raid System</label>
            </div>

            <div class="d-flex justify-content-end">
                <button type="submit" class="btn btn-primary">Save Anti-Raid Settings</button>
            </div>
        </form>
    </div>
</div>

<div class="plugin-card mt-4">
    <div class="plugin-card-header">
        <h4><i class="fas fa-user-check me-2"></i> Verification Gate</h4>
    </div>
    <div class="plugin-card-body">
        <form action="/manage/<%= guild.id %>/update-verification" method="POST">
            <p class="text-muted">Require new members to click a button to verify before gaining access to the server. Use <code>/verification setup</code> to create the panel.</p>

            <div class="mb-3">
                <label for="verification-role" class="form-label">Role to Grant</label>
                <select class="form-select" id="verification-role" name="verification_role_id">
                    <option value="">-- Select a Role --</option>
                    <% roles.forEach(role => { %>
                        <option value="<%= role.id %>" <%= (joinGateConfig && joinGateConfig.verification_role_id === role.id) ? 'selected' : '' %>>@<%= role.name %></option>
                    <% }); %>
                </select>
            </div>

            <div class="form-check form-switch mb-3">
                <input class="form-check-input" type="checkbox" role="switch" id="verification-enabled" name="verification_enabled" <%= (joinGateConfig && joinGateConfig.verification_enabled) ? 'checked' : '' %>>
                <label class="form-check-label" for="verification-enabled">Enable Verification Gate</label>
            </div>
            
            <p class="small text-muted fst-italic">Note: Enabling this will prevent new members from getting autoroles until they verify.</p>

            <div class="d-flex justify-content-end">
                <button type="submit" class="btn btn-primary">Save Settings</button>
            </div>
        </form>
    </div>
</div>