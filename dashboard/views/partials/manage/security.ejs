<div class="row">
    <div class="col-12">
        <h3>Security</h3>
        <p class="text-muted">Protect your server from raids, malicious users, and other threats.</p>
    </div>
</div>

<div class="content-card mt-4">
    <div class="card-body">
        <h4 class="card-title">Join Gate</h4>
        <p class="card-subtitle mb-3 text-muted">Require new members to pass a verification step before they can access the server.</p>
        <form action="/manage/<%= guild.id %>/security/joingate" method="POST">
            <div class="mb-3">
                <label for="joinGateEnabled" class="form-label">Enable Join Gate</label>
                <div class="form-check form-switch">
                    <input class="form-check-input" type="checkbox" role="switch" id="joinGateEnabled" name="enabled" <%= joinGateConfig && joinGateConfig.enabled ? 'checked' : '' %>>
                    <label class="form-check-label" for="joinGateEnabled">Enable</label>
                </div>
            </div>
            <div class="mb-3">
                <label for="joinGateRole" class="form-label">Verification Role</label>
                <select class="form-select" id="joinGateRole" name="roleId">
                    <option value="">Select a role</option>
                    <% roles.forEach(role => { %>
                        <option value="<%= role.id %>" <%= joinGateConfig && joinGateConfig.role_id === role.id ? 'selected' : '' %>><%= role.name %></option>
                    <% }) %>
                </select>
                <div class="form-text">This role will be granted upon successful verification.</div>
            </div>
            <button type="submit" class="btn btn-primary">Save Settings</button>
        </form>
    </div>
</div>

<div class="content-card mt-4">
    <div class="card-body">
        <h4 class="card-title">Anti-Raid</h4>
        <p class="card-subtitle mb-3 text-muted">Automatically detect and take action against potential raid attempts.</p>
        <form action="/manage/<%= guild.id %>/security/antiraid" method="POST">
            <div class="mb-3">
                <label for="antiRaidEnabled" class="form-label">Enable Anti-Raid</label>
                <div class="form-check form-switch">
                    <input class="form-check-input" type="checkbox" role="switch" id="antiRaidEnabled" name="enabled" <%= antiRaidConfig && antiRaidConfig.enabled ? 'checked' : '' %>>
                    <label class="form-check-label" for="antiRaidEnabled">Enable</label>
                </div>
            </div>
            <div class="mb-3">
                <label for="antiRaidThreshold" class="form-label">Join Threshold</label>
                <input type="number" class="form-control" id="antiRaidThreshold" name="threshold" value="<%= antiRaidConfig ? antiRaidConfig.threshold : '10' %>">
                <div class="form-text">Number of joins within the time period to trigger anti-raid.</div>
            </div>
            <div class="mb-3">
                <label for="antiRaidTimePeriod" class="form-label">Time Period (seconds)</label>
                <input type="number" class="form-control" id="antiRaidTimePeriod" name="timePeriod" value="<%= antiRaidConfig ? antiRaidConfig.time_period : '10' %>">
                <div class="form-text">The time frame in which to count the joins.</div>
            </div>
            <button type="submit" class="btn btn-primary">Save Settings</button>
        </form>
    </div>
</div>

<div class="content-card mt-4">
    <div class="card-body">
        <h4 class="card-title">Anti-Nuke</h4>
        <p class="card-subtitle mb-3 text-muted">Protect your server from rapid channel/role deletions or mass bans.</p>
        <form action="/manage/<%= guild.id %>/security/antinuke" method="POST">
            <div class="mb-3">
                <label for="antiNukeEnabled" class="form-label">Enable Anti-Nuke</label>
                <div class="form-check form-switch">
                    <input class="form-check-input" type="checkbox" role="switch" id="antiNukeEnabled" name="enabled" <%= antiNukeConfig && antiNukeConfig.enabled ? 'checked' : '' %>>
                    <label class="form-check-label" for="antiNukeEnabled">Enable</label>
                </div>
            </div>
            <button type="submit" class="btn btn-primary">Save Settings</button>
        </form>
    </div>
</div>

<div class="content-card mt-4">
    <div class="card-body">
        <h4 class="card-title">Quarantine</h4>
        <p class="card-subtitle mb-3 text-muted">Isolate users with a specific role, restricting their access to the rest of the server.</p>
        <form action="/manage/<%= guild.id %>/security/quarantine" method="POST">
            <div class="mb-3">
                <label for="quarantineEnabled" class="form-label">Enable Quarantine</label>
                <div class="form-check form-switch">
                    <input class="form-check-input" type="checkbox" role="switch" id="quarantineEnabled" name="enabled" <%= quarantineConfig && quarantineConfig.enabled ? 'checked' : '' %>>
                    <label class="form-check-label" for="quarantineEnabled">Enable</label>
                </div>
            </div>
            <div class="mb-3">
                <label for="quarantineRole" class="form-label">Quarantine Role</label>
                <select class="form-select" id="quarantineRole" name="roleId">
                    <option value="">Select a role</option>
                    <% roles.forEach(role => { %>
                        <option value="<%= role.id %>" <%= quarantineConfig && quarantineConfig.role_id === role.id ? 'selected' : '' %>><%= role.name %></option>
                    <% }) %>
                </select>
                <div class="form-text">Users with this role will be considered quarantined.</div>
            </div>
            <button type="submit" class="btn btn-primary">Save Settings</button>
        </form>
    </div>
</div>