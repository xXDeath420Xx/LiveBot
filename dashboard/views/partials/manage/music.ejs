<div class="page-section">
    <div class="page-section-header">
        <div>
            <div class="page-section-title">
                <i class="fas fa-music"></i>
                <span>Music System</span>
            </div>
            <div class="page-section-subtitle">
                Configure the bot's music features for your server
            </div>
        </div>
    </div>

    <!-- General Settings -->
    <div style="margin-bottom: var(--spacing-6);">
        <h3 style="font-size: var(--font-size-lg); font-weight: var(--font-weight-bold); color: var(--color-text-primary); margin-bottom: var(--spacing-4);">
            <i class="fas fa-cog" style="color: var(--color-primary-400);"></i>
            General Music Settings
        </h3>
        <form action="/manage/<%= guild.id %>/music/config" method="POST">
            <div class="form-check" style="margin-bottom: var(--spacing-4);">
                <input class="form-check-input" type="checkbox" id="musicEnabled" name="enabled" <%= (musicConfig && musicConfig.enabled) ? 'checked' : '' %>>
                <label class="form-check-label" for="musicEnabled">
                    Enable Music Module
                </label>
            </div>

            <div style="margin-bottom: var(--spacing-4);">
                <label class="form-label">DJ Role</label>
                <select class="form-select" name="djRoleId">
                    <option value="">None</option>
                    <% roles.forEach(role => { %>
                        <option value="<%= role.id %>" <%= (musicConfig && musicConfig.dj_role_id === role.id) ? 'selected' : '' %>><%= role.name %></option>
                    <% }) %>
                </select>
                <div class="form-help">Users with this role can bypass most music command restrictions</div>
            </div>

            <button type="submit" class="btn btn-primary">
                <i class="fas fa-save"></i>
                <span>Save General Settings</span>
            </button>
        </form>
    </div>

    <!-- AI DJ Settings -->
    <div style="margin-bottom: var(--spacing-6);">
        <h3 style="font-size: var(--font-size-lg); font-weight: var(--font-weight-bold); color: var(--color-text-primary); margin-bottom: var(--spacing-4);">
            <i class="fas fa-microphone" style="color: var(--color-accent-purple);"></i>
            AI DJ
        </h3>
        <form action="/manage/<%= guild.id %>/music/dj" method="POST">
            <div class="form-check" style="margin-bottom: var(--spacing-4);">
                <input class="form-check-input" type="checkbox" id="djEnabled" name="djEnabled" <%= (musicConfig && musicConfig.dj_enabled) ? 'checked' : '' %>>
                <label class="form-check-label" for="djEnabled">
                    Enable AI DJ
                </label>
            </div>
            <div style="font-size: var(--font-size-sm); color: var(--color-text-secondary); margin-bottom: var(--spacing-4);">
                The bot will announce tracks and provide commentary like a radio DJ
            </div>

            <div style="margin-bottom: var(--spacing-4);">
                <label class="form-label">DJ Voice</label>
                <select class="form-select" name="djVoice">
                    <% if (availableDJVoices && availableDJVoices.length > 0) { %>
                        <%
                        const usVoices = availableDJVoices.filter(v => v.category === 'US English');
                        const gbVoices = availableDJVoices.filter(v => v.category === 'British English');
                        %>
                        <% if (usVoices.length > 0) { %>
                            <optgroup label="ðŸ‡ºðŸ‡¸ US English">
                                <% usVoices.forEach(voice => { %>
                                    <option value="<%= voice.value %>" <%= (musicConfig && musicConfig.dj_voice === voice.value) ? 'selected' : '' %>><%= voice.label %></option>
                                <% }); %>
                            </optgroup>
                        <% } %>
                        <% if (gbVoices.length > 0) { %>
                            <optgroup label="ðŸ‡¬ðŸ‡§ British English">
                                <% gbVoices.forEach(voice => { %>
                                    <option value="<%= voice.value %>" <%= (musicConfig && musicConfig.dj_voice === voice.value) ? 'selected' : '' %>><%= voice.label %></option>
                                <% }); %>
                            </optgroup>
                        <% } %>
                    <% } else { %>
                        <option value="female">ðŸ‡ºðŸ‡¸ Female (Default)</option>
                        <option value="male">ðŸ‡ºðŸ‡¸ Male (Default)</option>
                    <% } %>
                </select>
                <div class="form-help">Choose the voice personality for your AI DJ. Total voices available: <%= availableDJVoices ? availableDJVoices.length : 0 %></div>
            </div>

            <button type="submit" class="btn btn-primary">
                <i class="fas fa-save"></i>
                <span>Save AI DJ Settings</span>
            </button>
        </form>
    </div>

    <!-- Playlist Settings -->
    <div style="margin-bottom: var(--spacing-6);">
        <h3 style="font-size: var(--font-size-lg); font-weight: var(--font-weight-bold); color: var(--color-text-primary); margin-bottom: var(--spacing-4);">
            <i class="fas fa-list" style="color: var(--color-success);"></i>
            Playlists
        </h3>
        <form action="/manage/<%= guild.id %>/music/playlists" method="POST">
            <div class="grid grid-cols-2" style="gap: var(--spacing-4); margin-bottom: var(--spacing-4);">
                <div>
                    <label class="form-label">Max Playlists Per User</label>
                    <input type="number" class="form-control" name="maxPlaylists" value="<%= musicConfig.max_playlists_per_user || 10 %>" min="1" max="50">
                    <div class="form-help">Maximum playlists each user can create</div>
                </div>
                <div>
                    <label class="form-label">Max Songs Per Playlist</label>
                    <input type="number" class="form-control" name="maxSongsPerPlaylist" value="<%= musicConfig.max_songs_per_playlist || 100 %>" min="10" max="1000">
                    <div class="form-help">Maximum songs in each playlist</div>
                </div>
            </div>

            <button type="submit" class="btn btn-primary">
                <i class="fas fa-save"></i>
                <span>Save Playlist Settings</span>
            </button>
        </form>
    </div>

    <!-- Audio Filters -->
    <div>
        <h3 style="font-size: var(--font-size-lg); font-weight: var(--font-weight-bold); color: var(--color-text-primary); margin-bottom: var(--spacing-4);">
            <i class="fas fa-sliders-h" style="color: var(--color-warning);"></i>
            Enabled Audio Filters
        </h3>
        <p style="font-size: var(--font-size-sm); color: var(--color-text-secondary); margin-bottom: var(--spacing-4);">
            Select which audio filters are available for use in your server
        </p>
        <form action="/manage/<%= guild.id %>/music/filters" method="POST">
            <div style="background: var(--color-dark-600); border: 1px solid var(--color-dark-400); border-radius: var(--radius-lg); padding: var(--spacing-4); margin-bottom: var(--spacing-4);">
                <div class="grid grid-cols-3" style="gap: var(--spacing-3);">
                    <% const availableFilters = ['bassboost', '8D', 'vaporwave', 'nightcore', 'phaser', 'tremolo', 'vibrato', 'reverse', 'treble', 'normalizer', 'surrounding', 'pulsator', 'subboost', 'karaoke', 'flanger', 'gate', 'haas', 'mcompand']; %>
                    <% availableFilters.forEach(filter => { %>
                        <div class="form-check">
                            <input class="form-check-input" type="checkbox" name="filters[]" value="<%= filter %>" id="filter-<%= filter %>" <%= (musicConfig.enabled_filters && musicConfig.enabled_filters.includes(filter)) ? 'checked' : '' %>>
                            <label class="form-check-label" for="filter-<%= filter %>" style="text-transform: capitalize;">
                                <%= filter %>
                            </label>
                        </div>
                    <% }); %>
                </div>
            </div>

            <button type="submit" class="btn btn-primary">
                <i class="fas fa-save"></i>
                <span>Save Filter Settings</span>
            </button>
        </form>
    </div>
</div>

<style>
.form-label {
    display: block;
    font-size: var(--font-size-sm);
    font-weight: var(--font-weight-semibold);
    color: var(--color-text-primary);
    margin-bottom: var(--spacing-2);
}

.form-help {
    font-size: var(--font-size-xs);
    color: var(--color-text-muted);
    margin-top: var(--spacing-2);
}

.form-check {
    display: flex;
    align-items: center;
    gap: var(--spacing-2);
}

.form-check-input {
    width: 18px;
    height: 18px;
    cursor: pointer;
}

.form-check-label {
    font-size: var(--font-size-sm);
    color: var(--color-text-secondary);
    cursor: pointer;
    user-select: none;
}
</style>
