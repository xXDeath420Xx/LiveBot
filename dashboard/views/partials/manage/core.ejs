<div class="content-card">
    <h2><i class="fas fa-cogs me-2"></i>Core Server Settings</h2>
    <p class="text-muted">Manage the main announcement channel and live role for your server. These are the default settings unless overridden in a specific channel or for a specific streamer.</p>
    <hr class="my-4">
    <form action="/manage/<%= guild.id %>/settings" method="POST">
        <div class="row">
            <div class="col-md-6 mb-3">
                <label class="form-label">Default Announce Channel</label>
                <select name="channelId" class="form-select">
                    <% channels.forEach(channel => { %>
                        <option value="<%= channel.id %>" <%= settings.announcement_channel_id == channel.id ? 'selected' : '' %> >#<%= channel.name %></option>
                    <% }) %>
                </select>
            </div>
            <div class="col-md-6 mb-3">
                <label class="form-label">Live Role</label>
                <select name="roleId" class="form-select">
                    <option value="">Disabled</option>
                    <% roles.forEach(role => { %>
                        <option value="<%= role.id %>" <%= settings.live_role_id == role.id ? 'selected' : '' %>>@<%= role.name %></option>
                    <% }) %>
                </select>
            </div>
        </div>
        <div class="row mt-3">
            <div class="col-md-6 mb-3">
                <label for="privacy_setting" class="form-label">Content Privacy Preference</label>
                <select name="privacy_setting" id="privacy_setting" class="form-select">
                    <option value="public_only" <%= (settings.privacy_setting || 'public_only') === 'public_only' ? 'selected' : '' %>>Announce Public Streams Only</option>
                    <option value="all" <%= settings.privacy_setting === 'all' ? 'selected' : '' %>>Announce All Streams (Public & Private/Subscriber-only)</option>
                </select>
                <div class="form-text">Determines whether to announce streams that are not public (e.g., subscriber-only).</div>
            </div>
            <div class="col-md-6 mb-3">
                <label for="summary_persistence" class="form-label">Stream Summary Persistence</label>
                <select name="summary_persistence" id="summary_persistence" class="form-select">
                    <option value="delete_on_offline" <%= (settings.summary_persistence || 'delete_on_offline') === 'delete_on_offline' ? 'selected' : '' %>>Delete Announcement When Stream Ends</option>
                    <option value="keep_on_offline" <%= settings.summary_persistence === 'keep_on_offline' ? 'selected' : '' %>>Keep Announcement When Stream Ends</option>
                </select>
                <div class="form-text">Controls if the announcement message is removed after a streamer goes offline.</div>
            </div>
        </div>
        <button type="submit" class="btn btn-primary w-100 mt-3"><i class="fas fa-save me-2"></i>Save Core Settings</button>
    </form>
</div>